"use strict";const e=require("../../common/vendor.js");var t=getApp();const o={components:{},data:()=>({list:[],page:1,loading:!1,preview:0,downloadIndex:""}),props:{},methods:{onLoad:function(){},onShow:function(){this.history()},onReachBottom:function(){this.page=this.page+1,this.history()},history:function(){this.loading=!0,e.index.showLoading({title:"加载中..."}),t.globalData.apiRequest({url:"/records",data:{page:this.page},success:e=>{this.list=this.list.concat(e.data.data),this.preview=e.data.preview},complete:t=>{this.loading=!1,e.index.hideLoading()}})},videoPlay:function(t){var o=t.currentTarget.dataset.idx,i=this.downloadIndex;if(i){var n=e.index.createVideoContext("download"+i);n.seek(0),n.pause(),this.downloadIndex=o,e.index.createVideoContext("download"+i).play()}else this.downloadIndex=o,e.index.createVideoContext("download"+o).play()},Download:function(t){console.log(t),e.index.setClipboardData({data:t.currentTarget.dataset.link}),e.index.reLaunch({url:"/pages/index/index"})},DEL:function(o){var i=o.currentTarget.dataset.id,n=o.currentTarget.dataset.key;e.index.showModal({title:"提示",content:"你确定要删除吗？",success:e=>{e.confirm?t.globalData.apiRequest({url:"/records/"+i,method:"DELETE",success:e=>{this.list.splice(n,1),this.list=this.list}}):e.cancel}})},Copy_video_info:function(t){e.index.setClipboardData({data:t.currentTarget.dataset.content,success:function(o){e.index.showToast({title:t.currentTarget.dataset.tip,duration:1200})}})},onShareAppMessage:function(t){if("button"===t.from){var o=t.target.dataset.content;return{title:o.title,imageUrl:o.cover,path:"/pages/index/index?history="+o.url}}return{title:this.config_data_list.share_title,path:"/pages/index/index",imageUrl:this.config_data_list.share_imageUrl,success:function(t){e.index.showToast({title:"分享成功",icon:"success",duration:2e3})},fail:function(t){e.index.showToast({title:"分享失败",icon:"none",duration:2e3})}}}},created:function(){}};const i=e._export_sfc(o,[["render",function(t,o,i,n,a,d){return e.e({a:!a.list||0==a.list.length},(a.list&&a.list.length,{}),{b:e.f(a.list,((t,o,i)=>e.e({a:e.t(t.url),b:e.o(((...e)=>d.Copy_video_info&&d.Copy_video_info(...e)),o),c:e.o(((...e)=>d.Copy_video_info&&d.Copy_video_info(...e)),o),d:t.url,e:t},0!=a.preview?{f:t.image_url,g:e.o(((...e)=>d.Copy_video_info&&d.Copy_video_info(...e)),o),h:e.o(((...e)=>d.Copy_video_info&&d.Copy_video_info(...e)),o),i:t.image_url,j:e.o(((...e)=>d.videoPlay&&d.videoPlay(...e)),o),k:o,l:e.t(t.updated_at)}:{},{m:e.o(((...e)=>d.Copy_video_info&&d.Copy_video_info(...e)),o),n:e.o(((...e)=>d.Copy_video_info&&d.Copy_video_info(...e)),o),o:t.url,p:e.o(((...e)=>d.Download&&d.Download(...e)),o),q:t.url,r:e.o(((...e)=>d.DEL&&d.DEL(...e)),o),s:o,t:t.id,v:o}))),c:0!=a.preview})}]]);o.__runtimeHooks=2,wx.createPage(i);
