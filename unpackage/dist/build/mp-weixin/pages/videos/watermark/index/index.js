"use strict";const e=require("../../../../common/vendor.js"),t=require("../../../../utils/util.js"),i=getApp(),o={data:()=>({userInfo:{},videoUrl:"https://v.douyin.com/iF1TAe2/"}),onLoad:function(){},onShow(){},methods:{inputClear:function(){this.videoUrl=""},regUrl:function(e){return/(http|ftp|https):\/\/[\w\-_]+(\.[\w\-_]+)+([\w\-\.,@?^=%&:/~\+#]*[\w\-\@?^=%&/~\+#])?/.test(e)},submit:function(){var o,a=t.util.formatDate(new Date,"");e.index.getStorageSync("lastParseDate")!=a?(e.index.setStorageSync("lastParseDate",a),e.index.setStorageSync("dailyFreeParseNum",i.globalData.defaultDailyFreeParseNum),o=i.globalData.defaultDailyFreeParseNum):o=e.index.getStorageSync("dailyFreeParseNum"),o>0?this.parseVideo():e.index.showToast({title:"免费解析次数已用完！",icon:"none"})},parsePlatform(e){const t=e.match(/:\/\/(.[^/]+)/)[1];console.log("domainArr:",t);const i=t.split(":")[0];let o="";const a={douyin:["douyin.com"],weishi:["qq.com"],kuaishou:["kuaishou.com","chenzhongtech.com","kuaishouapp.com"],zuiyou:["izuiyou.com"],pipixia:["hulushequ.com","pipix.com"],pipigaoxiao:["ippzone.com"]};for(let r in a){a[r].forEach((e=>{i.indexOf(e)>-1&&(o=r)}))}return o},matchUrl(e){let t=e.match(/((https?|ftp):\/\/)?([A-Z0-9]+\.)+[A-Z]{2,6}(\/?[A-Z0-9]+\??([A-Z0-9]+\=[A-Z0-9]+(\&[A-Z0-9]+\=[A-Z0-9]+)*)?)*/gi);return t?t[0]:""},parseVideo:function(){const t={douyin:"http://api.txapi.cn/v1/parse_short_video/dy",weishi:"http://api.txapi.cn/v1/parse_short_video/ws",kuaishou:"http://api.txapi.cn/v1/parse_short_video/ks",xiaohongshu:"http://api.txapi.cn/v1/parse_short_video/xhs",pipixia:"http://api.txapi.cn/v1/c/parse_short_video/ppx",zuiyou:"http://api.txapi.cn/v1/c/parse_short_video/zy"}[this.parsePlatform(this.videoUrl)];if(!t)return e.index.showToast({icon:"error",title:"请输入正确的地址！"}),!1;const o=e.Bs.importObject("request-agent-middleware"),a={token:i.globalData.txAPIToken,url:this.matchUrl(this.videoUrl)};o.agent(t,a,{method:"GET"}).then((t=>{const{code:i,data:o}=t.data;if(200===i){const{cover_url:t,video_url:i,title:a}=o;e.index.setStorageSync("dailyFreeParseNum",e.index.getStorageSync("dailyFreeParseNum")-1),e.index.navigateTo({url:"../video/video?url="+encodeURIComponent(i)+"&image="+encodeURIComponent(t)+"&preview=1&title="+encodeURIComponent(a)})}}))}}};const a=e._export_sfc(o,[["render",function(t,i,o,a,r,n){return e.e({a:e.n("swiper-item "+t.item),b:e.n("swiper-item "+t.item),c:r.videoUrl,d:e.o((e=>r.videoUrl=e.detail.value)),e:""==r.videoUrl},(r.videoUrl,{}),{f:e.o(((...e)=>n.inputClear&&n.inputClear(...e))),g:e.o(((...e)=>n.submit&&n.submit(...e)))})}]]);wx.createPage(a);
