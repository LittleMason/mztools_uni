"use strict";const t=require("../../../../common/vendor.js");getApp();var e="";const o={data:()=>({dataUrl:"",dataImage:"",preview:0,title:""}),onLoad:function(t){this.dataUrl=decodeURIComponent(t.url),this.dataImage=decodeURIComponent(t.image),this.title=decodeURIComponent(t.title),console.log("options:",t),this.preview=t.preview},onUnload:function(){e&&e.abort()},methods:{goBack:function(){t.index.switchTab({url:"/pages/index/index"})},copyUrl:function(){t.index.setClipboardData({data:this.dataUrl,success:function(e){t.index.showToast({title:"复制成功",duration:1200})}})},download:function(){var o=this,n=this.dataUrl;t.index.showLoading({title:"保存中 0%"}),(e=t.index.downloadFile({url:n,success:function(e){t.index.hideLoading(),t.index.saveVideoToPhotosAlbum({filePath:e.tempFilePath,success:function(e){o.showToast("保存成功","success"),setTimeout((function(){t.index.setClipboardData({data:""}),o.goBack()}),1e3)},fail:function(t){o.showToast("保存失败")}})},fail:function(n){e=null,t.index.hideLoading(),o.showToast("下载失败")}})).onProgressUpdate((function(e){100===e.progress||t.index.showLoading({title:"保存中 "+e.progress+"%"})}))},postSave:function(e){var o=this;t.index.getSetting({success:function(e){e.authSetting["scope.writePhotosAlbum"]?o.download():t.index.authorize({scope:"scope.writePhotosAlbum",success:function(){o.download()},fail:function(e){t.index.showModal({title:"提示",content:"视频保存到相册需获取相册权限请允许开启权限",confirmText:"确认",cancelText:"取消",success:function(e){e.confirm&&t.index.openSetting({success:function(t){}})}})}})}})},showToast:function(e){if(arguments.length>1&&void 0!==arguments[1])var o=arguments[1];else o="none";if(arguments.length>2&&void 0!==arguments[2])var n=arguments[2];else n=1500;t.index.showToast({title:e,icon:o,duration:n})}}};const n=t._export_sfc(o,[["render",function(e,o,n,i,a,s){return t.e({a:0!=a.preview&&""!=a.dataUrl},0!=a.preview&&""!=a.dataUrl?{b:a.dataUrl,c:a.dataImage}:{d:a.dataImage},{e:t.t(a.title),f:t.o(((...t)=>s.postSave&&s.postSave(...t))),g:t.o(((...t)=>s.copyUrl&&s.copyUrl(...t))),h:t.o(((...t)=>s.goBack&&s.goBack(...t)))})}]]);wx.createPage(n);
